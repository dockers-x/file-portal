<!doctype html>
<html>
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>Login</title>
<link rel="stylesheet" href="/assets/styles.css">
<style>
body {
  display: flex;
  flex-direction: column;
  min-height: 100vh;
  background: var(--bg);
  overflow-x: hidden;
  margin: 0;
}
.main-wrap {
  flex: 1;
  display: flex;
  justify-content: center;
  align-items: center;
}
.card {
  max-width: 420px;
  width: 90%;
}
.btn-group {
  display: flex;
  justify-content: flex-end;
  gap: 8px;
  margin-top: 10px;
}
</style>
</head>
<body>
  <div class="header">
    <div class="brand">
      <img class="brand-logo" style="height:24px">
      <div class="brand-title">File Management</div>
    </div>
  </div>

  <div class="main-wrap">
    <div class="card">
      <h2>Login</h2>
      <div id="err" class="muted" style="display:none;margin-bottom:8px"></div>
      <input type="password" id="pw" placeholder="Password" autocomplete="off" />
      <div class="btn-group">
        <button type="button" class="btn" onclick="clearPw()">Clear</button>
        <button type="button" class="btn blue" onclick="doLogin()">Login</button>
      </div>
    </div>
  </div>

  <div class="footer">Powered by ChatGPT • © iAmSaugata</div>
  <div class="toast"></div>

  <script src="/assets/common.js"></script>
  <script>
  // --- Wait until DOM ready ---
  window.addEventListener('DOMContentLoaded', () => {
    try { loadBrand(); } catch (e) {}
  });

  function clearPw() {
    document.getElementById('pw').value = '';
  }

  async function doLogin() {
    const pw = document.getElementById('pw').value.trim();
    if (!pw) { toast('Enter password','info'); return; }
    try {
      const r = await fetch('/login', {
        method: 'POST',
        headers: {'Content-Type':'application/x-www-form-urlencoded'},
        body: new URLSearchParams({password: pw})
      });
      if (!r.ok) {
        document.getElementById('err').style.display = 'block';
        document.getElementById('err').textContent = 'Invalid password';
        return;
      }
      localStorage.setItem('authed', '1');
      window.location.href = '/dashboard';
    } catch (e) {
      toast('Login failed','error');
    }
  }
  </script>
</body>
</html>
